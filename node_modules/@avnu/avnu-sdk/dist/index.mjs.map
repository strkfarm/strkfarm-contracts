{"version":3,"sources":["../src/constants.ts","../src/fixtures.ts","../src/types.ts","../src/services.ts"],"sourcesContent":["export const SEPOLIA_BASE_URL = 'https://sepolia.api.avnu.fi';\nexport const BASE_URL = 'https://starknet.api.avnu.fi';\n","import { parseUnits } from 'ethers';\nimport { constants } from 'starknet';\nimport {\n  BuildSwapTransaction,\n  InvokeSwapResponse,\n  Page,\n  Price,\n  PriceRequest,\n  Quote,\n  QuoteRequest,\n  Source,\n  SourceType,\n  Token,\n} from './types';\n\nexport const aPriceRequest = (): PriceRequest => ({\n  sellTokenAddress: '0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7',\n  sellAmount: parseUnits('1', 18),\n  buyTokenAddress: '0x72df4dc5b6c4df72e4288857317caf2ce9da166ab8719ab8306516a2fddfff7',\n});\n\nexport const aQuoteRequest = (): QuoteRequest => ({\n  sellTokenAddress: '0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7',\n  sellAmount: parseUnits('1', 18),\n  buyTokenAddress: '0x72df4dc5b6c4df72e4288857317caf2ce9da166ab8719ab8306516a2fddfff7',\n  size: 1,\n  takerAddress: '0x0',\n});\n\nexport const aPrice = (): Price => ({\n  sellTokenAddress: '0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7',\n  sellAmount: parseUnits('1', 18),\n  sellAmountInUsd: 1700,\n  buyTokenAddress: '0x72df4dc5b6c4df72e4288857317caf2ce9da166ab8719ab8306516a2fddfff7',\n  buyAmount: parseUnits('2', 18),\n  buyAmountInUsd: 1700,\n  blockNumber: 1,\n  chainId: constants.StarknetChainId.SN_SEPOLIA,\n  sourceName: 'AMM1',\n  priceRatioUsd: 0,\n  gasFees: BigInt(0),\n  gasFeesInUsd: 0,\n});\n\nexport const aQuote = (): Quote => ({\n  quoteId: 'quoteId',\n  sellTokenAddress: '0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7',\n  sellAmount: parseUnits('1', 18),\n  sellAmountInUsd: 1700,\n  buyTokenAddress: '0x72df4dc5b6c4df72e4288857317caf2ce9da166ab8719ab8306516a2fddfff7',\n  buyAmount: parseUnits('2', 18),\n  buyAmountInUsd: 1700,\n  buyAmountWithoutFees: parseUnits('2', 18),\n  buyAmountWithoutFeesInUsd: 1700,\n  blockNumber: 1,\n  chainId: constants.StarknetChainId.SN_SEPOLIA,\n  expiry: 100000000000,\n  routes: [\n    {\n      name: 'AMM1',\n      address: '0x975910cd99bc56bd289eaaa5cee6cd557f0ddafdb2ce6ebea15b158eb2c661',\n      percent: 1,\n      sellTokenAddress: '0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7',\n      buyTokenAddress: '0x72df4dc5b6c4df72e4288857317caf2ce9da166ab8719ab8306516a2fddfff7',\n      routes: [],\n    },\n  ],\n  gasFees: BigInt('0x0'),\n  gasFeesInUsd: 0,\n  avnuFees: BigInt('0x0'),\n  avnuFeesInUsd: 0,\n  avnuFeesBps: BigInt('0x0'),\n  integratorFees: BigInt('0x0'),\n  integratorFeesInUsd: 0,\n  integratorFeesBps: BigInt('0x0'),\n  priceRatioUsd: 0,\n  liquiditySource: 'DEX_AGGREGATOR',\n  gasless: {\n    active: false,\n    gasTokenPrices: [],\n  },\n});\n\nexport const aQuoteWithManySubRoutes = (): Quote => ({\n  quoteId: 'quoteId',\n  sellTokenAddress: '0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7',\n  sellAmount: parseUnits('1', 18),\n  sellAmountInUsd: 1700,\n  buyTokenAddress: '0x72df4dc5b6c4df72e4288857317caf2ce9da166ab8719ab8306516a2fddfff7',\n  buyAmount: parseUnits('2', 18),\n  buyAmountInUsd: 1700,\n  buyAmountWithoutFees: parseUnits('2', 18),\n  buyAmountWithoutFeesInUsd: 1700,\n  blockNumber: 1,\n  chainId: constants.StarknetChainId.SN_SEPOLIA,\n  expiry: 100000000000,\n  priceRatioUsd: 0,\n  liquiditySource: 'DEX_AGGREGATOR',\n  routes: [\n    {\n      name: 'AMM1',\n      address: '0x975910cd99bc56bd289eaaa5cee6cd557f0ddafdb2ce6ebea15b158eb2c661',\n      percent: 1,\n      sellTokenAddress: '0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7',\n      buyTokenAddress: '0x3e85bfbb8e2a42b7bead9e88e9a1b19dbccf661471061807292120462396ec9',\n      routes: [\n        {\n          name: 'AMM2',\n          address: '0x975910cd99bc56bd289eaaa5cee6cd557f0ddafdb2ce6ebea15b158eb2c662',\n          percent: 1,\n          sellTokenAddress: '0x3e85bfbb8e2a42b7bead9e88e9a1b19dbccf661471061807292120462396ec9',\n          buyTokenAddress: '0x2e2faab2cad8ecdde5e991798673ddcc08983b872304a66e5f99fbb24e14abc',\n          routes: [\n            {\n              name: 'AMM1',\n              address: '0x975910cd99bc56bd289eaaa5cee6cd557f0ddafdb2ce6ebea15b158eb2c661',\n              percent: 1,\n              sellTokenAddress: '0x2e2faab2cad8ecdde5e991798673ddcc08983b872304a66e5f99fbb24e14abc',\n              buyTokenAddress: '0x72df4dc5b6c4df72e4288857317caf2ce9da166ab8719ab8306516a2fddfff7',\n              routes: [],\n            },\n          ],\n        },\n      ],\n    },\n  ],\n  gasFees: BigInt('0x0'),\n  gasFeesInUsd: 0,\n  avnuFees: BigInt('0x0'),\n  avnuFeesInUsd: 0,\n  avnuFeesBps: BigInt('0x0'),\n  integratorFees: BigInt('0x0'),\n  integratorFeesInUsd: 0,\n  integratorFeesBps: BigInt('0x0'),\n  gasless: {\n    active: false,\n    gasTokenPrices: [],\n  },\n});\n\nexport const aQuoteWithManyComplexRoutes = (): Quote => ({\n  quoteId: 'quoteId',\n  sellTokenAddress: '0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7',\n  sellAmount: parseUnits('1', 18),\n  sellAmountInUsd: 1700,\n  buyTokenAddress: '0x72df4dc5b6c4df72e4288857317caf2ce9da166ab8719ab8306516a2fddfff7',\n  buyAmount: parseUnits('2', 18),\n  buyAmountInUsd: 1700,\n  buyAmountWithoutFees: parseUnits('2', 18),\n  buyAmountWithoutFeesInUsd: 1700,\n  blockNumber: 1,\n  chainId: constants.StarknetChainId.SN_SEPOLIA,\n  expiry: 100000000000,\n  gasFees: BigInt('0x0'),\n  gasFeesInUsd: 0,\n  avnuFees: BigInt('0x0'),\n  avnuFeesInUsd: 0,\n  avnuFeesBps: BigInt('0x0'),\n  integratorFees: BigInt('0x0'),\n  integratorFeesInUsd: 0,\n  integratorFeesBps: BigInt('0x0'),\n  priceRatioUsd: 0,\n  liquiditySource: 'DEX_AGGREGATOR',\n  routes: [\n    {\n      name: 'AMM1',\n      address: '0x975910cd99bc56bd289eaaa5cee6cd557f0ddafdb2ce6ebea15b158eb2c661',\n      percent: 0.5,\n      sellTokenAddress: '0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7',\n      buyTokenAddress: '0x3e85bfbb8e2a42b7bead9e88e9a1b19dbccf661471061807292120462396ec9',\n      routes: [\n        {\n          name: 'AMM2',\n          address: '0x975910cd99bc56bd289eaaa5cee6cd557f0ddafdb2ce6ebea15b158eb2c662',\n          percent: 0.5,\n          sellTokenAddress: '0x3e85bfbb8e2a42b7bead9e88e9a1b19dbccf661471061807292120462396ec9',\n          buyTokenAddress: '0x2e2faab2cad8ecdde5e991798673ddcc08983b872304a66e5f99fbb24e14abc',\n          routes: [\n            {\n              name: 'AMM1',\n              address: '0x975910cd99bc56bd289eaaa5cee6cd557f0ddafdb2ce6ebea15b158eb2c661',\n              percent: 1,\n              sellTokenAddress: '0x2e2faab2cad8ecdde5e991798673ddcc08983b872304a66e5f99fbb24e14abc',\n              buyTokenAddress: '0x72df4dc5b6c4df72e4288857317caf2ce9da166ab8719ab8306516a2fddfff7',\n              routes: [],\n            },\n          ],\n        },\n        {\n          name: 'AMM1',\n          address: '0x975910cd99bc56bd289eaaa5cee6cd557f0ddafdb2ce6ebea15b158eb2c661',\n          percent: 0.5,\n          sellTokenAddress: '0x3e85bfbb8e2a42b7bead9e88e9a1b19dbccf661471061807292120462396ec9',\n          buyTokenAddress: '0x72df4dc5b6c4df72e4288857317caf2ce9da166ab8719ab8306516a2fddfff7',\n          routes: [],\n        },\n      ],\n    },\n    {\n      name: 'AMM1',\n      address: '0x975910cd99bc56bd289eaaa5cee6cd557f0ddafdb2ce6ebea15b158eb2c661',\n      percent: 0.2,\n      sellTokenAddress: '0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7',\n      buyTokenAddress: '0x72df4dc5b6c4df72e4288857317caf2ce9da166ab8719ab8306516a2fddfff7',\n      routes: [],\n    },\n    {\n      name: 'AMM1',\n      address: '0x975910cd99bc56bd289eaaa5cee6cd557f0ddafdb2ce6ebea15b158eb2c661',\n      percent: 0.3,\n      sellTokenAddress: '0x49d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7',\n      buyTokenAddress: '0x3e85bfbb8e2a42b7bead9e88e9a1b19dbccf661471061807292120462396ec9',\n      routes: [\n        {\n          name: 'AMM2',\n          address: '0x975910cd99bc56bd289eaaa5cee6cd557f0ddafdb2ce6ebea15b158eb2c662',\n          percent: 0.2,\n          sellTokenAddress: '0x3e85bfbb8e2a42b7bead9e88e9a1b19dbccf661471061807292120462396ec9',\n          buyTokenAddress: '0x72df4dc5b6c4df72e4288857317caf2ce9da166ab8719ab8306516a2fddfff7',\n          routes: [],\n        },\n        {\n          name: 'AMM1',\n          address: '0x975910cd99bc56bd289eaaa5cee6cd557f0ddafdb2ce6ebea15b158eb2c661',\n          percent: 0.8,\n          sellTokenAddress: '0x3e85bfbb8e2a42b7bead9e88e9a1b19dbccf661471061807292120462396ec9',\n          buyTokenAddress: '0x72df4dc5b6c4df72e4288857317caf2ce9da166ab8719ab8306516a2fddfff7',\n          routes: [],\n        },\n      ],\n    },\n  ],\n  gasless: {\n    active: false,\n    gasTokenPrices: [],\n  },\n});\n\nexport const anInvokeSwapResponse = (): InvokeSwapResponse => ({\n  transactionHash: '0x0',\n});\n\nexport const aBuildSwapTransaction = (): BuildSwapTransaction => ({\n  chainId: constants.StarknetChainId.SN_SEPOLIA,\n  calls: [\n    {\n      contractAddress: '0x0',\n      entrypoint: 'execute',\n      calldata: [],\n    },\n  ],\n});\n\nexport const ethToken = (): Token => ({\n  name: 'Ethereum',\n  address: '0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7',\n  symbol: 'ETH',\n  decimals: 18,\n  chainId: '0x534e5f474f45524c49',\n  logoUri:\n    'https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png',\n});\n\nexport const btcToken = (): Token => ({\n  name: 'Wrapped Bitcoin',\n  address: '0x72df4dc5b6c4df72e4288857317caf2ce9da166ab8719ab8306516a2fddfff7',\n  symbol: 'WBTC',\n  decimals: 18,\n  chainId: '0x534e5f474f45524c49',\n  logoUri:\n    'https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599/logo.png',\n});\n\nexport const aPage = <T>(content: T[], size = 10, number = 0, totalPages = 1, totalElements = 1): Page<T> => ({\n  content,\n  size,\n  totalPages,\n  number,\n  totalElements,\n});\n\nexport const aSource = (): Source => ({\n  name: 'AMM1',\n  address: '0x975910cd99bc56bd289eaaa5cee6cd557f0ddafdb2ce6ebea15b158eb2c661',\n  icon: 'https://pbs.twimg.com/profile_images/1567441002063069184/SGtDtW-C_400x400.jpg',\n  type: SourceType.DEX,\n});\n","import { Call } from 'starknet';\n\nexport interface Pageable {\n  page?: number;\n  size?: number;\n  sort?: string;\n}\n\nexport type GetTokensRequest = Pageable;\n\nexport interface Page<T> {\n  content: T[];\n  totalPages: number;\n  totalElements: number;\n  size: number;\n  number: number;\n}\n\nexport interface Token {\n  name: string;\n  address: string;\n  symbol: string;\n  decimals: number;\n  chainId: string;\n  logoUri: string;\n}\n\nexport interface PriceRequest {\n  sellTokenAddress: string;\n  buyTokenAddress: string;\n  sellAmount: bigint;\n}\n\nexport interface QuoteRequest {\n  sellTokenAddress: string;\n  buyTokenAddress: string;\n  sellAmount?: bigint;\n  buyAmount?: bigint;\n  takerAddress?: string;\n  size?: number;\n  excludeSources?: string[];\n  integratorFees?: bigint;\n  integratorFeeRecipient?: string;\n  integratorName?: string;\n}\n\nexport interface Route {\n  name: string;\n  address: string;\n  percent: number;\n  sellTokenAddress: string;\n  buyTokenAddress: string;\n  routeInfo?: Map<string, string>;\n  routes: Route[];\n}\n\nexport interface Price {\n  sellTokenAddress: string;\n  sellAmount: bigint;\n  sellAmountInUsd: number;\n  buyTokenAddress: string;\n  buyAmount: bigint;\n  buyAmountInUsd: number;\n  blockNumber?: number;\n  chainId: string;\n  sourceName: string;\n  priceRatioUsd: number;\n  gasFees: bigint;\n  gasFeesInUsd: number;\n}\n\nexport interface Quote {\n  quoteId: string;\n  sellTokenAddress: string;\n  sellAmount: bigint;\n  sellAmountInUsd: number;\n  buyTokenAddress: string;\n  buyAmount: bigint;\n  buyAmountInUsd: number;\n  buyAmountWithoutFees: bigint;\n  buyAmountWithoutFeesInUsd: number;\n  blockNumber?: number;\n  chainId: string;\n  expiry?: number;\n  routes: Route[];\n  gasFees: bigint;\n  gasFeesInUsd: number;\n  avnuFees: bigint;\n  avnuFeesInUsd: number;\n  avnuFeesBps: bigint;\n  integratorFees: bigint;\n  integratorFeesInUsd: number;\n  integratorFeesBps: bigint;\n  priceRatioUsd: number;\n  sellTokenPriceInUsd?: number;\n  buyTokenPriceInUsd?: number;\n  liquiditySource: 'DEX_AGGREGATOR' | 'MARKET_MAKER' | 'SOLVER';\n  gasless: Gasless;\n}\n\nexport interface Gasless {\n  active: boolean;\n  gasTokenPrices: { tokenAddress: string; gasFeesInUsd: number; gasFeesInGasToken: bigint }[];\n}\n\nexport interface InvokeSwapResponse {\n  transactionHash: string;\n  gasTokenAddress?: string;\n  gasTokenAmount?: bigint;\n}\n\nexport interface RequestError {\n  messages: string[];\n  revertError: string | undefined;\n}\n\nexport interface AvnuOptions {\n  baseUrl?: string;\n  abortSignal?: AbortSignal;\n  avnuPublicKey?: string;\n}\n\nexport interface ExecuteSwapOptions {\n  executeApprove?: boolean;\n  gasless?: boolean;\n  gasTokenAddress?: string;\n  maxGasTokenAmount?: bigint;\n  slippage?: number;\n  executeGaslessTxCallback?: () => unknown;\n}\n\nexport interface BuildSwapTransaction {\n  chainId: string;\n  calls: Call[];\n}\n\nexport enum SourceType {\n  DEX = 'DEX',\n  MARKET_MAKER = 'MARKET_MAKER',\n  SOLVER = 'SOLVER',\n}\n\nexport interface Source {\n  name: string;\n  address: string;\n  icon?: string;\n  type: SourceType;\n}\n\nexport class ContractError {\n  constructor(\n    public message: string,\n    public revertError: string,\n  ) {}\n}\n","import { toBeHex } from 'ethers';\nimport qs from 'qs';\nimport { AccountInterface, ec, hash, Signature, TypedData } from 'starknet';\nimport { BASE_URL, SEPOLIA_BASE_URL } from './constants';\nimport {\n  AvnuOptions,\n  BuildSwapTransaction,\n  ContractError,\n  ExecuteSwapOptions,\n  GetTokensRequest,\n  InvokeSwapResponse,\n  Page,\n  Price,\n  PriceRequest,\n  Quote,\n  QuoteRequest,\n  RequestError,\n  Source,\n  Token,\n} from './types';\n\nconst getBaseUrl = (): string => (process.env.NODE_ENV === 'dev' ? SEPOLIA_BASE_URL : BASE_URL);\n\nconst parseResponse = <T>(response: Response, avnuPublicKey?: string): Promise<T> => {\n  if (response.status === 400) {\n    return response.json().then((error: RequestError) => {\n      throw new Error(error.messages[0]);\n    });\n  }\n  if (response.status === 500) {\n    return response.json().then((error: RequestError) => {\n      if (error.messages.length >= 0 && error.messages[0].includes('Contract error')) {\n        throw new ContractError(error.messages[0], error.revertError || '');\n      } else {\n        throw new Error(error.messages[0]);\n      }\n    });\n  }\n  if (response.status > 400) {\n    throw new Error(`${response.status} ${response.statusText}`);\n  }\n  if (avnuPublicKey) {\n    const signature = response.headers.get('signature');\n    if (!signature) throw new Error('No server signature');\n    return response\n      .clone()\n      .text()\n      .then((textResponse) => {\n        const hashResponse = hash.computeHashOnElements([hash.starknetKeccak(textResponse)]);\n        const formattedSig = signature.split(',').map((s) => BigInt(s));\n        const signatureType = new ec.starkCurve.Signature(formattedSig[0], formattedSig[1]);\n        if (!ec.starkCurve.verify(signatureType, hashResponse, avnuPublicKey))\n          throw new Error('Invalid server signature');\n      })\n      .then(() => response.json());\n  }\n  return response.json();\n};\n\n/**\n * Fetches the prices of DEX applications.\n * It allows to find the prices of AMM without any path optimization. It allows to measure the performance of the results from the getQuotes endpoints. The prices are sorted (best first).\n *\n * @returns The best quotes\n * @param request The request params for the avnu API `/swap/v2/prices` endpoint.\n * @param options Optional options.\n */\nconst fetchPrices = (request: PriceRequest, options?: AvnuOptions): Promise<Price[]> => {\n  const queryParams = qs.stringify({ ...request, sellAmount: toBeHex(request.sellAmount) }, { arrayFormat: 'repeat' });\n  return fetch(`${options?.baseUrl ?? getBaseUrl()}/swap/v2/prices?${queryParams}`, {\n    signal: options?.abortSignal,\n    headers: { ...(options?.avnuPublicKey !== undefined && { 'ask-signature': 'true' }) },\n  })\n    .then((response) => parseResponse<Price[]>(response, options?.avnuPublicKey))\n    .then((prices) =>\n      prices.map((price) => ({\n        ...price,\n        sellAmount: BigInt(price.sellAmount),\n        buyAmount: BigInt(price.buyAmount),\n        gasFees: BigInt(price.gasFees),\n      })),\n    );\n};\n\n/**\n * Fetches the best quotes.\n * It allows to find the best quotes from on-chain and off-chain liquidity. The best quotes will be returned and are sorted (best first).\n *\n * @param request The request params for the avnu API `/swap/v2/quotes` endpoint.\n * @param options Optional options.\n * @returns The best quotes\n */\nconst fetchQuotes = (request: QuoteRequest, options?: AvnuOptions): Promise<Quote[]> => {\n  if (!request.sellAmount && !request.buyAmount) throw new Error('Sell amount or buy amount is required');\n  const queryParams = qs.stringify(\n    {\n      ...request,\n      buyAmount: request.buyAmount ? toBeHex(request.buyAmount) : undefined,\n      sellAmount: request.sellAmount ? toBeHex(request.sellAmount) : undefined,\n      integratorFees: request.integratorFees ? toBeHex(request.integratorFees) : undefined,\n    },\n    { arrayFormat: 'repeat' },\n  );\n  return fetch(`${options?.baseUrl ?? getBaseUrl()}/swap/v2/quotes?${queryParams}`, {\n    signal: options?.abortSignal,\n    headers: { ...(options?.avnuPublicKey !== undefined && { 'ask-signature': 'true' }) },\n  })\n    .then((response) => parseResponse<Quote[]>(response, options?.avnuPublicKey))\n    .then((quotes) =>\n      quotes.map((quote) => ({\n        ...quote,\n        sellAmount: BigInt(quote.sellAmount),\n        buyAmount: BigInt(quote.buyAmount),\n        buyAmountWithoutFees: BigInt(quote.buyAmountWithoutFees),\n        gasFees: BigInt(quote.gasFees),\n        avnuFees: BigInt(quote.avnuFees),\n        integratorFees: BigInt(quote.integratorFees),\n        avnuFeesBps: BigInt(quote.avnuFeesBps),\n        integratorFeesBps: BigInt(quote.integratorFeesBps),\n        gasless: quote.gasless && {\n          active: quote.gasless.active,\n          gasTokenPrices: quote.gasless.gasTokenPrices.map((gasTokenPrice) => ({\n            tokenAddress: gasTokenPrice.tokenAddress,\n            gasFeesInUsd: gasTokenPrice.gasFeesInUsd,\n            gasFeesInGasToken: BigInt(gasTokenPrice.gasFeesInGasToken),\n          })),\n        },\n      })),\n    );\n};\n\n/**\n * Executing the exchange through AVNU router\n *\n * @param quoteId The id of the selected quote\n * @param signature The typed data's signature\n * @param options Optional options.\n * @returns The transaction hash\n */\nconst fetchExecuteSwapTransaction = (\n  quoteId: string,\n  signature: Signature,\n  options?: AvnuOptions,\n): Promise<InvokeSwapResponse> => {\n  if (Array.isArray(signature)) {\n    signature = signature.map((sig) => toBeHex(BigInt(sig)));\n  } else if (signature.r && signature.s) {\n    signature = [toBeHex(BigInt(signature.r)), toBeHex(BigInt(signature.s))];\n  }\n  return fetch(`${options?.baseUrl ?? getBaseUrl()}/swap/v2/execute`, {\n    method: 'POST',\n    headers: {\n      Accept: 'application/json',\n      'Content-Type': 'application/json',\n      ...(options?.avnuPublicKey && { 'ask-signature': 'true' }),\n    },\n    body: JSON.stringify({ quoteId, signature }),\n  }).then((response) => parseResponse<InvokeSwapResponse>(response, options?.avnuPublicKey));\n};\n\n/**\n * Build data for executing the exchange through AVNU router\n * It allows trader to build the data needed for executing the exchange on AVNU router\n *\n * @param quoteId The id of the selected quote\n * @param takerAddress Required when taker address was not provided during the quote request\n * @param slippage The maximum acceptable slippage of the buyAmount amount. Default value is 5%. 0.05 is 5%.\n * This value is ignored if slippage is not applicable to the selected quote\n * @param includeApprove If true, the response will contain the approve call. True by default.\n * @param options Optional options.\n * @returns The calldata\n */\nconst fetchBuildExecuteTransaction = (\n  quoteId: string,\n  takerAddress?: string,\n  slippage?: number,\n  includeApprove?: boolean,\n  options?: AvnuOptions,\n): Promise<BuildSwapTransaction> =>\n  fetch(`${options?.baseUrl ?? getBaseUrl()}/swap/v2/build`, {\n    method: 'POST',\n    headers: {\n      Accept: 'application/json',\n      'Content-Type': 'application/json',\n      ...(options?.avnuPublicKey && { 'ask-signature': 'true' }),\n    },\n    body: JSON.stringify({ quoteId, takerAddress, slippage, includeApprove }),\n  }).then((response) => parseResponse<BuildSwapTransaction>(response, options?.avnuPublicKey));\n\n/**\n * Build typed-data. Once signed by the user, the signature can be sent to the API to be executed by AVNU\n *\n * @param quoteId The id of the selected quote\n * @param gasTokenAddress The gas token address that will be used to pay the gas fees\n * @param maxGasTokenAmount The maximum amount of gas token the user accepts to spend\n * @param includeApprove If true, the typed data will contains the approve call\n * @param takerAddress Required when taker address was not provided during the quote request\n * @param slippage The maximum acceptable slippage of the buyAmount amount. Default value is 5%. 0.05 is 5%.\n * This value is ignored if slippage is not applicable to the selected quote\n * @param options Optional options.\n * @returns The calldata\n */\nconst fetchBuildSwapTypedData = (\n  quoteId: string,\n  gasTokenAddress: string,\n  maxGasTokenAmount: bigint,\n  includeApprove: boolean = true,\n  takerAddress?: string,\n  slippage?: number,\n  options?: AvnuOptions,\n): Promise<TypedData> =>\n  fetch(`${options?.baseUrl ?? getBaseUrl()}/swap/v2/build-typed-data`, {\n    method: 'POST',\n    headers: {\n      Accept: 'application/json',\n      'Content-Type': 'application/json',\n      ...(options?.avnuPublicKey && { 'ask-signature': 'true' }),\n    },\n    body: JSON.stringify({\n      quoteId,\n      takerAddress,\n      slippage,\n      includeApprove,\n      gasTokenAddress,\n      maxGasTokenAmount: toBeHex(maxGasTokenAmount),\n    }),\n  }).then((response) => parseResponse<TypedData>(response, options?.avnuPublicKey));\n\n/**\n * Fetches the supported tokens.\n *\n * @param request The request params for the avnu API `/swap/v2/tokens` endpoint.\n * @param options Optional options.\n * @returns The best quotes\n */\nconst fetchTokens = (request?: GetTokensRequest, options?: AvnuOptions): Promise<Page<Token>> =>\n  fetch(`${options?.baseUrl ?? getBaseUrl()}/swap/v2/tokens?${qs.stringify(request ?? {})}`, {\n    signal: options?.abortSignal,\n    headers: { ...(options?.avnuPublicKey && { 'ask-signature': 'true' }) },\n  }).then((response) => parseResponse<Page<Token>>(response, options?.avnuPublicKey));\n\n/**\n * Fetches the supported sources\n *\n * @param options Optional options.\n * @returns The sources\n */\nconst fetchSources = (options?: AvnuOptions): Promise<Source[]> =>\n  fetch(`${options?.baseUrl ?? getBaseUrl()}/swap/v2/sources`, {\n    signal: options?.abortSignal,\n    headers: { ...(options?.avnuPublicKey && { 'ask-signature': 'true' }) },\n  }).then((response) => parseResponse<Source[]>(response, options?.avnuPublicKey));\n\n/**\n * Execute the exchange\n *\n * @param account The account of the trader\n * @param quote The selected quote. See `getQuotes`\n * @param executeApprove False if the taker already executed `approve`\n * @param gasless False if the user wants to execute the transaction himself\n * @param gasTokenAddress The gas token address that will be used to pay the gas fees (required when gasless is true)\n * @param maxGasTokenAmount The maximum amount of gas token that the user is willing to spend (required when gasless is true)\n * @param executeGaslessTxCallback This function is called after the user signed the typed data and just before calling the API to execute the transaction\n * @param slippage The maximum acceptable slippage of the buyAmount amount. Default value is 5%. 0.05 is 5%.\n * This value is ignored if slippage is not applicable to the selected quote\n * @param options Optional options.\n * @returns Promise<InvokeSwapResponse>\n */\nconst executeSwap = async (\n  account: AccountInterface,\n  quote: Quote,\n  {\n    executeApprove = true,\n    gasless = false,\n    gasTokenAddress,\n    maxGasTokenAmount,\n    slippage = 0.005,\n    executeGaslessTxCallback,\n  }: ExecuteSwapOptions = {},\n  options?: AvnuOptions,\n): Promise<InvokeSwapResponse> => {\n  const chainId = await account.getChainId();\n  if (chainId !== quote.chainId) {\n    throw Error(`Invalid chainId`);\n  }\n\n  if (gasless) {\n    if (!gasTokenAddress || !maxGasTokenAmount) {\n      throw Error(`Should provide gasTokenAddress and maxGasTokenAmount when gasless is true`);\n    }\n    const typedData = await fetchBuildSwapTypedData(\n      quote.quoteId,\n      gasTokenAddress,\n      maxGasTokenAmount,\n      executeApprove,\n      account.address,\n      slippage,\n      options,\n    );\n    const signature = await account.signMessage(typedData);\n    if (executeGaslessTxCallback) {\n      executeGaslessTxCallback();\n    }\n    return fetchExecuteSwapTransaction(quote.quoteId, signature, options).then((value) => ({\n      transactionHash: value.transactionHash,\n      gasTokenAddress: value.gasTokenAddress,\n      gasTokenAmount: BigInt(value.gasTokenAmount!),\n    }));\n  } else {\n    return fetchBuildExecuteTransaction(quote.quoteId, account.address, slippage, executeApprove, options)\n      .then(({ calls }) => account.execute(calls))\n      .then((value) => ({ transactionHash: value.transaction_hash }));\n  }\n};\n\n/**\n * Calculate the min amount received from amount and slippage\n *\n * @param amount The amount to apply slippage\n * @param slippage The slippage to apply in bps. 10 is 0.1%\n * @returns bigint\n */\nconst calculateMinAmount = (amount: bigint, slippage: number): bigint =>\n  amount - (amount * BigInt(slippage)) / BigInt(10000);\n\nexport {\n  calculateMinAmount,\n  executeSwap,\n  fetchBuildExecuteTransaction,\n  fetchBuildSwapTypedData,\n  fetchExecuteSwapTransaction,\n  fetchPrices,\n  fetchQuotes,\n  fetchSources,\n  fetchTokens,\n};\n"],"mappings":"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","names":["SourceType"]}